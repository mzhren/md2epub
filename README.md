# Markdown转EPUB工具

一个使用Python+Tkinter开发的桌面应用程序，用于将Markdown文件或目录转换为EPUB电子书格式。

## 功能特性

- 支持单个Markdown文件或整个目录的转换
- 支持自定义封面图片
- 支持自动生成目录（从标题提取）或自定义目录
- 支持设置作者和标题信息
- 智能图片处理功能
- 多平台支持（Windows/macOS）

## 安装说明

### 方法1：从源码运行

1. 克隆或下载本仓库
2. 安装依赖库：
   ```
   pip install -r requirements.txt
   ```
3. 运行应用程序：
   ```
   python app.py
   ```

### 方法2：使用可执行文件

#### Windows
下载并运行 `Markdown2EPUB.exe`

#### macOS
下载并运行 `Markdown2EPUB.app`

## 使用说明

### 基本使用流程

1. 选择输入文件或目录：单击"选择文件"或"选择目录"按钮
2. 设置图片目录（可选）：如果Markdown文件引用了图片，可以指定图片目录
3. 选择输出路径：选择生成的EPUB文件保存位置
4. 填写书籍信息：输入标题、作者
5. 选择封面图片（可选）
6. 设置目录选项：使用自动生成目录或自定义目录
7. 点击"转换为EPUB"按钮开始转换

### 图片处理说明

程序会按照以下顺序查找Markdown中引用的图片：

1. 如果是网络图片链接（http/https），直接使用
2. 如果是绝对路径，直接使用
3. 在Markdown文档所在目录中查找（相对路径）
4. 在用户指定的图片目录中查找
5. 在用户指定的图片目录中以文件名（不含路径）查找

如果点击"使用默认图片目录"按钮，程序会自动设置图片目录为Markdown文档所在目录下的"images"子目录。

### 目录生成说明

- **自动生成目录**：程序会自动从Markdown文档中提取h1、h2、h3级别的标题，并按层级结构生成目录
- **自定义目录**：用户可以按照指定格式（标题|文件名）手动输入目录项

## 注意事项

1. **Markdown格式**：程序支持标准Markdown语法和部分扩展语法（如表格）
2. **图片路径**：为了更好的兼容性，建议使用相对路径引用图片
3. **标题层级**：目录生成会使用文档中的h1、h2、h3标题，请合理组织文档标题结构
4. **文件编码**：Markdown文件应使用UTF-8编码以确保正确处理中文
5. **目录结构**：如果转换整个目录，建议保持目录结构清晰，每个章节一个文件

## 常见问题解答

### Q: 为什么我的图片没有显示在EPUB中？
A: 请检查图片路径是否正确，图片文件是否存在。程序会尝试从多个位置查找图片，但如果路径完全错误或图片不存在，则无法添加。可以尝试使用默认图片目录功能来简化图片管理。

### Q: 生成的目录结构不正确怎么办？
A: 检查Markdown文档中的标题层级是否合理。如果自动生成的目录不符合预期，可以尝试使用自定义目录功能手动设置目录结构。

### Q: 如何创建多章节的电子书？
A: 可以将多个章节保存为单独的Markdown文件，放在同一个目录中，然后选择该目录进行转换。程序会按文件名字母顺序处理文件。

### Q: 如何设置封面图片？
A: 点击"选择封面"按钮，选择一个图片文件（推荐使用JPG或PNG格式）。封面图片将显示在电子书的开始部分。

### Q: 在MacOS上运行时遇到权限问题怎么办？
A: 如果使用的是打包版本，可能需要在"系统偏好设置->安全性与隐私"中允许应用运行。如果是从源码运行，确保有相应目录的读写权限。

## 打包说明

### Windows打包

运行以下命令创建Windows可执行文件：
```
python build_exe.py
```

### macOS打包

在macOS系统上运行以下命令创建macOS应用程序：
```
python build_mac.py
```

## 许可证

本项目采用MIT许可证。
